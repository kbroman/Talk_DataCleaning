\documentclass[aspectratio=169,12pt,t]{beamer}
\usepackage{graphicx}
\setbeameroption{hide notes}
\setbeamertemplate{note page}[plain]
\usepackage{listings}
\usepackage{eepic}

\input{header.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% end of header
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% title info
\title{data cleaning principles}
\author{\vspace*{-10pt} \href{https://kbroman.org}{Karl Broman}}
\institute{Biostatistics \& Medical Informatics, UW{\textendash}Madison}
\date{\href{https://twitter.com/kwbroman}{\tt \scriptsize \color{foreground} @kwbroman}
\\[-4pt]
\href{https://kbroman.org}{\tt \scriptsize \color{foreground} kbroman.org}
\\[-4pt]
\href{https://github.com/kbroman}{\tt \scriptsize \color{foreground} github.com/kbroman}
\\[-4pt]
{\scriptsize \href{https://kbroman.org/Talk_DataCleaning}{\tt kbroman.org/Talk\_DataCleaning}}
}


\begin{document}

% title slide
{
\setbeamertemplate{footline}{} % no page number here
\frame{
  \titlepage

  \vfill \hfill
  \href{https://creativecommons.org/publicdomain/zero/1.0/}{\includegraphics[height=7mm]{Figs/cc-zero.png}}

  \note{
    These are slides for a talk for the csv,conf,v6 ({\tt
    https://csvconf.com/}) on May 4-5, 2021.

    Data analysts spend a lot of time organizing and cleaning data,
    but few of us have been trained to do so. Why is that?

    Some say that data cleaning is difficult to generalize. But I
    think there are some general principles. Moreover, I think we have
    an important shared experience in data cleaning that we can
    commiserate about, and through which we can learn from each other.
  }

} }


\begin{frame}[c]{}

\centering
\Large

Tidy data are all alike, \\[3pt]
but every messy dataset  \\[3pt]
is messy in its own way.

\bigskip\bigskip

\hspace{5cm} --
\href{https://r4ds.had.co.nz/tidy-data.html}{Hadley Wickham}



\note{
  Hadley's talking more about data organization than data
  cleanliness.  And his point is that if you make data tidy, it
  simplifies all the downstream analyses.

  But {\hilit is} every messy dataset {\vhilit uniquely} messy?

  For sure, my collaborators have shown impressive creativity in their
  organization and management of data. But we do see the same sorts of
  problems over and over.
}
\end{frame}


\begin{frame}[c]{}

\centering
\Large

If I clean up [Medicare] data ...\\[3pt]
does any of the knowledge I gain ...\\[3pt]
apply to the processing of RNA-seq data?


\bigskip\bigskip

\hspace{5cm} --
\href{https://doi.org/10.1080/10618600.2017.1385470}{Roger Peng}



\note{
  In his discussion of David Donoho's paper about data science, Roger
  Peng wrote about how data cleaning is frustratingly difficult to
  generalize.

  But my answer to his question is {\vhilit absolutely!}

  A person with experience cleaning one dataset has important
  experience to draw upon when moving to another dataset even if it's
  of a totally different nature.
}
\end{frame}



\begin{frame}[c]{}


  \href{https://datamishapsnight.com}{\figh{Figs/data_mishaps_night.png}{1.0}}

  \vspace{-7mm}
  \hfill
  \begin{minipage}[c]{0.33\textwidth}
    {\footnotesize Caitlin Hudon \& Laura Ellis}

    \href{https://datamishapsnight.com}{\lolit \tt dataMishapsNight.com}
  \end{minipage}

\note{
  In February, 2021, Caitlin Hudon and Laura Ellis organized an
  Friday evening conference where 16 people gave short presentations on data
  mishaps.

  Many of the stories concerned mistakes in data cleaning, and while these
  weren't necessarily the most amusing stories, they did seem to
  bring out a strong sense of shared experience. We have suffered
  and struggled through very similar data problems.
}
\end{frame}



\begin{frame}[c]{Data cleaning}


\vspace*{-6pt}

\bbi
\item tedious
\item embarrassing
\item needs context
\item doesnâ€™t feel like progress
\item requires creativity
\item requires coding prowess
\item source of most problems
\ei

\note{
  Really, I think we don't usually teach data cleaning
  because it's something we prefer to keep private.

  We're shy about it.

  And data cleaning code is our ugliest code.
}
\end{frame}



\begin{frame}[c]{}

  \figh{Figs/logo.pdf}{0.8}

\note{
  I'm proposing a set of basic principles for data cleaning, and
  splitting them into five groups. There are some fundamental
  principles, followed by four basic ideas: verify things that you
  expect, explore to find further oddities, ask questions, and
  document what you've done.
}
\end{frame}


\begin{frame}{}
\lfigh{Figs/logo_fundamentals.pdf}{0.2}

\bigskip\bigskip\bigskip

\centering
\Large

{\princolorA 1. Don't clean data when you're tired or hungry.}

\bigskip\bigskip

\large
\hspace{5cm}
(paraphrasing \href{https://twitter.com/ghazalgulati}{Ghazal Gulati})


\note{
  At her talk at the Data Mishaps night, Ghazal Gulati emphasized this
  point, of not cleaning data when you're tired or hungry.

  Data cleaning requires considerable concentration, and you need to
  allow sufficient time to do the work. If you're in a hurry, you'll
  miss things.
}
\end{frame}


\begin{frame}{}
\lfigh{Figs/logo_fundamentals.pdf}{0.2}

\bigskip\bigskip\bigskip

\centering
\Large

{\princolorA 2. Don't trust anyone (even yourself)}

\only<2>{
\bigskip\bigskip
\large

``my motto is `trust no one' \hspace{1cm} \\[3pt]
\hspace{1cm} ...except maybe @kwbroman?''

\bigskip

\hspace{5cm}
-- \href{https://twitter.com/JennyBryan/status/595689693162938368}{Jenny Bryan}
}

\note{
}
\end{frame}



\begin{frame}{}
\lfigh{Figs/logo_fundamentals.pdf}{0.2}

\bigskip\bigskip\bigskip

\only<1|handout 0>{
\centering
\Large

{\princolorA 3. Think about what might have gone wrong \\[8pt]
  and how it might be revealed}
}

\only<2>{
  \vspace*{-25mm}
  \hspace{0.4\textwidth} {\princolorA 3. Think about what might have gone wrong} \\
  \hspace{0.4\textwidth} {\color{background} 3.}
            {\princolorA and how it might be revealed} \hspace{20.5mm}

\vspace{0.08\textheight}

\figh{Figs/sample_mixups.png}{0.78}
}


\note{
  Personally, I think this is the most important principle for data
  cleaning. It has been central in guiding my approach.

  I need a good figure for this.
}
\end{frame}


\begin{frame}{}
\lfigh{Figs/logo_fundamentals.pdf}{0.2}

\vspace{-15mm} \hspace{0.4\textwidth}
{\princolorA 4. Use care in merging}


\vspace{0.12\textheight}

\includegraphics[height=0.6\textheight]{Figs/spreadsheet_colnames.pdf}

\vspace*{-0.45\textheight}
\hspace*{0.22\textwidth}
\includegraphics[height=0.6\textheight]{Figs/spreadsheet_colnames2.pdf}


\note{
  Many problems arise due to mistakes when merging data from multiple
  files. A common problem is a change in the data arrangement, such as
  in the order of columns.

  Focus on the labels (which are more likely correct), rather than the
  position of variables in a file (which are more likely to change).
}
\end{frame}


\begin{frame}{}
\lfigh{Figs/logo_fundamentals.pdf}{0.2}

\bigskip\bigskip\bigskip

\centering
\Large

{\princolorA 5. Dates \& categories suck}


\note{
  You may ask, ``How is that a principle?''
}
\end{frame}


\begin{frame}{}

\bigskip \bigskip \bigskip \bigskip

\Large

{\color{title} Principle:} \hspace{50mm}

\centering

\bigskip \bigskip

{\hilit a fundamental truth that guides our thinking}


\note{
  I was thinking the same thing. Was I drifting away from principles
  and more to just stuff to know or do?  This seems a pretty good
  definition.
}
\end{frame}


\begin{frame}{}
\lfigh{Figs/logo_fundamentals.pdf}{0.2}

\bigskip\bigskip\bigskip

\centering
\Large

{\princolorA 5. Dates \& categories suck}


\note{
  So yeah, this counts as a principle.

  Much of the pain will be in the dates and categorical data;
  you should be ready for that.
}
\end{frame}




\begin{frame}{}
\lfigh{Figs/logo_verify.pdf}{0.2}

\vspace{-15mm} \hspace{0.4\textwidth}
{\princolorB 6. Check that distinct things are distinct}

\note{
}
\end{frame}


\begin{frame}{}
\lfigh{Figs/logo_verify.pdf}{0.2}

\vspace{-15mm} \hspace{0.4\textwidth}
{\princolorB 7. Check that matching things match}

\note{
}
\end{frame}



\begin{frame}{}
\lfigh{Figs/logo_verify.pdf}{0.2}

\vspace{-15mm} \hspace{0.4\textwidth}
{\princolorB 8. Check calculations}

\note{
}
\end{frame}



\begin{frame}{}
\lfigh{Figs/logo_verify.pdf}{0.2}

\centering
\Large

\bigskip \bigskip \bigskip

{\princolorB 9. Look for other instances of a problem}

\note{
}
\end{frame}



\begin{frame}{}
\lfigh{Figs/logo_explore.pdf}{0.2}

\vspace{-15mm} \hspace{0.4\textwidth}
{\princolorC 10. Make lots of plots}

\vspace{0.15\textheight}

\only<1>{\figh{Figs/il3.pdf}{0.75}}
\only<2|handout 0>{\figh{Figs/body_weight.pdf}{0.75}}
\only<3|handout 0>{\figh{Figs/adipose_weight.pdf}{0.75}}
\only<4|handout 0>{\figh{Figs/spreadsheet_g_v_mg.pdf}{0.75}}


\note{
}
\end{frame}


\begin{frame}{}
\lfigh{Figs/logo_explore.pdf}{0.2}

\vspace{-15mm} \hspace{0.4\textwidth}
{\princolorC 11. Look at missing value patterns}

\vspace{0.12\textheight}

\figh{Figs/scatter_na.pdf}{0.8}

\note{
visdat: https://docs.ropensci.org/visdat/

naniar: http://naniar.njtierney.com/
}
\end{frame}


\begin{frame}{}
\lfigh{Figs/logo_explore.pdf}{0.2}

\vspace{-15mm} \hspace{0.4\textwidth}
       {\princolorC 12. With massive data,} \\
\hspace{0.4\textwidth} {\color{background} 12.} {\princolorC make more plots not fewer}

\note{
}
\end{frame}


\begin{frame}{}
\lfigh{Figs/logo_explore.pdf}{0.2}

\vspace{-15mm} \hspace{0.4\textwidth}
{\princolorC 13. Follow up all artifacts}

\note{
}
\end{frame}


\begin{frame}{}
\lfigh{Figs/logo_ask.pdf}{0.2}

\hfill
\begin{minipage}[t]{0.9\textwidth}


\bbi
\princolorD
\item[\princolorD 14.] Ask questions
\item[\princolorD 15.] Ask for the primary data
\item[\princolorD 16.] Ask for metadata
\item[\princolorD 17.] Ask why data are missing
\ei

\end{minipage}

\note{
}
\end{frame}


\begin{frame}{}
\lfigh{Figs/logo_document.pdf}{0.2}

\hfill
\begin{minipage}[t]{0.9\textwidth}


\bbi
\princolorE
\item[\princolorE 18.] Create checklists \& pipelines
\item[\princolorE 19.] Document not just what but why
\item[\princolorE 20.] Expect to recheck
\ei

\end{minipage}

\note{
}
\end{frame}



\begin{frame}[c]{}

  \figh{Figs/logo_withtext.pdf}{0.95}

\note{
  In summary...
}
\end{frame}



\begin{frame}[c]{}

\Large

Slides: \href{https://kbroman.org/Talk_DataCleaning}{\tt kbroman.org/Talk\_DataCleaning}

\vspace*{-7mm}
\hfill
\href{https://creativecommons.org/publicdomain/zero/1.0/}{\includegraphics[height=7mm]{Figs/cc-zero.png}}

\vspace{5mm}

\href{https://kbroman.org}{\tt \lolit kbroman.org}

\vspace{7mm}

\href{https://github.com/kbroman}{\tt \lolit github.com/kbroman}

\vspace{7mm}

\href{https://twitter.com/kwbroman}{\tt \lolit @kwbroman}

\note{
}

\end{frame}




\end{document}
